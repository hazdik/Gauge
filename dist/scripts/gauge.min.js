$.fn.gauge=function(){"use strict";var DEFAULT_CANVAS_WIDTH=1060,DEFAULT_CANVAS_HEIGHT=500,DEFAULT_VALUE=50,DEFAULT_MAX=1e3,DEFAULT_RADIUS=75,DEFAULT_ANGLE_START=.7,DEFAULT_ANGLE_END=2.3,DEFAULT_LINE_WIDTH=2,DEFAULT_SECTORS=[{limitTo:1.9,color:"#666666"},{limitTo:2.2,color:"#ffa500"},{limitTo:2.3,color:"#ff0000"}],DEFAULT_ARROW_WIDTH=3,DEFAULT_ARROW_COLOR="#1e98e4",DEFAULT_ARROW_CIRCLE_RADIUS=7,DEFAULT_TICK_TEXT_COLOR="#444",DEFAULT_TICK_TEXT_SIZE="12",DEFAULT_TICK_TEXT_FONT="Serif",draw=function($elem){var _createCanvas=function(){$(".gauge").html('<canvas id="myCanvas" width="'+DEFAULT_CANVAS_WIDTH+'" height="'+DEFAULT_CANVAS_HEIGHT+'"></canvas>')},_ratinaScreenReSize=function(t){window.devicePixelRatio>1&&(t.width=DEFAULT_CANVAS_WIDTH,t.height=DEFAULT_CANVAS_HEIGHT,t.style.width=DEFAULT_CANVAS_WIDTH/2+"px",t.style.height=DEFAULT_CANVAS_HEIGHT/2+"px")},_getAttr=function(t){return $elem.attr("gauge-"+t)},_drawArc=function(){var canvas=document.getElementById("myCanvas"),context=canvas.getContext("2d"),x=canvas.width/2,y=canvas.height/2,radius=_getAttr("radius")||DEFAULT_RADIUS,startAngle=(+_getAttr("startAngle")||DEFAULT_ANGLE_START)*Math.PI,endAngle=(+_getAttr("endAngle")||DEFAULT_ANGLE_END)*Math.PI,counterClockwise=!1,sectors=eval(_getAttr("sectors"))||DEFAULT_SECTORS;_ratinaScreenReSize(canvas),context.lineWidth=_getAttr("lineWidth")||DEFAULT_LINE_WIDTH,context.beginPath(),context.arc(x,y,radius,startAngle,sectors[0].limitTo*Math.PI,counterClockwise),context.strokeStyle=sectors[0].color,context.stroke(),context.beginPath(),context.arc(x,y,radius,sectors[0].limitTo*Math.PI,sectors[1].limitTo*Math.PI,counterClockwise),context.strokeStyle=sectors[1].color,context.stroke(),context.beginPath(),context.arc(x,y,radius,sectors[1].limitTo*Math.PI,endAngle,counterClockwise),context.strokeStyle=sectors[2].color,context.stroke()},_drawArrow=function(){var t=document.getElementById("myCanvas"),e=t.getContext("2d"),r=_getAttr("arrow-width")||DEFAULT_ARROW_WIDTH,A=_getAttr("arrow-color")||DEFAULT_ARROW_COLOR,o=_getAttr("radius")||DEFAULT_RADIUS,_=_getAttr("arrow-circle-radius")||DEFAULT_ARROW_CIRCLE_RADIUS,a=0,i=+_getAttr("startAngle")||DEFAULT_ANGLE_START,n=+_getAttr("endAngle")||DEFAULT_ANGLE_END,T=+_getAttr("value")||DEFAULT_VALUE,c=+_getAttr("max")||DEFAULT_MAX,s=0,l=0;l=c/T,s=n/c+i,a=2/l,e.fillStyle=A,e.save(),e.beginPath(),e.translate(t.width/2,t.height/2),e.rotate(a*Math.PI),e.moveTo(0-r,0),e.lineTo(0,o),e.lineTo(0+r,0),e.lineTo(0-r,0),e.fill(),e.closePath(),e.restore(),e.beginPath(),e.arc(t.width/2,t.height/2,_,0,2*Math.PI,!1),e.fillStyle=A,e.fill()},_degToRad=function(t){return t*(Math.PI/180)},_drawTicks=function(){var t=document.getElementById("myCanvas"),e=t.getContext("2d"),r=_getAttr("tick-inner"),A=_getAttr("tick-size"),o=_getAttr("tick-color"),_=+_getAttr("radius"),a=+_getAttr("max"),i=+_getAttr("step"),n=0,T=0,c=0,s=0,l=0,E=0,g=0,h=0,D=0,L=0,d=0,U=0,I=0,F=_getAttr("tick-text-color")||DEFAULT_TICK_TEXT_COLOR,C=_getAttr("tick-text-size")||DEFAULT_TICK_TEXT_SIZE,u=_getAttr("tick-text-font")||DEFAULT_TICK_TEXT_FONT;n=r?_-A:_+A;for(var S=-54;235>S;S+=287*i/a)T=_degToRad(S),c=_-Math.cos(T)*n,s=_-Math.sin(T)*n,l=_-Math.cos(T)*_,E=_-Math.sin(T)*_,g=t.width/2-_+c,h=t.height/2-_+s,D=t.width/2-_+l,L=t.height/2-_+E,e.beginPath(),e.strokeStyle=o,e.moveTo(g,h),e.lineTo(D,L),e.stroke(),e.closePath(),e.font=C+"px "+u,e.fillStyle=F,U=t.width/2-(_+3)+(_-Math.cos(T)*(_+20)),I=t.height/2-(_-3)+(_-Math.sin(T)*(_+20)),e.fillText(d,U,I),d+=1};_createCanvas(),_drawArc(),_drawArrow(),_drawTicks()};$(window).load(function(){$(".gauge").each(function(){draw($(this))})})}();